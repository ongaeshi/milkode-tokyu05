! TokyuRuby会議05 LT 原稿

!! 準備
○ブラウザ 4 エディタ 3
○$ cd milkode_tokyu05 && milk web
○$ milk setdb milkode_tokyu05
○~/tmp/memo.txt を開いておく
○スライド開く、フルスクリーンモード

!! ページ1: Rubyで作ったソースコード検索エンジンMilkode
●スライドをフルスクリーン、文字サイズを調整する

こんにちはongaeshiと申します。普段は仕事としてコンシューマゲームのプログラマをしており、趣味でもソフトウェアを作って公開しています。今日は私が開発しているソースコード検索エンジンのMilkodeをご紹介させて頂きたいと思います。

!! ページ2: 作った動機
● [ENTER] コードを読むことの重要性は年々向上・・

コードリーディングの重要性が叫ばれるようになり久しいですが、そのためのツールは昔から余り変わっていません。

検索ツールにフォーカスを当てますと、grep等のコマンドラインツールは一つ一つファイルを調べるため時間がかかりますし、
Koders.com等のソースコード検索エンジンはAND検索が出来なかったり非公開のソースコードを検索することが出来ません。

● [ENTER] もっとコードリーディングを簡単にしたい

これらの不満点を解消し、もっとコードリーディングを簡単に行えるようにするためにMilkodeの開発を始めました。

!! ページ3: Milkodeの特徴
Milkodeの特徴です。

● [ENTER] 高速
まずはその高速性です。 20000ファイル位であれば1秒以内に検索することが出来ます。

● [ENTER] 行指向
Milkodeは行指向の検索エンジンです。一般的に検索エンジンは「特定の単語を含むファイル」を見つけますが、Milkodeは「特定の単語を含む行」を見つけます。 

● [ENTER] エディタでもブラウザでも
ブラウザ上で動作する"milk web"、コマンドラインツールの"gmilk"等を状況に応じて使い分けることが出来ます。ブラウザで検索したファイルをエディタで開くことも出来ます。

!! ページ4: デモ
それでは実際に動いている所をご紹介したいと思います。

● milk web画面を開く
milk web コマンドでアプリを起動するとこのような画面が表示されます。

現在はruby, mruby, node.js, rails 等のソースコードが登録されており、全部で13207ファイルあります。

さっそく検索してみましょう。試しに mrubyの String#split の実装を読んでみます。
まずはAND検索を使ってエントリポイントを探します、 rb_deine_method split .. はい出て来ました。
試しにrubyで同じキーワードで検索すると..、String以外にPathnameやBigdecimalにもsplitメソッドがあることが分かります。

mruby に戻りましょう。mrb_str_split_m 関数の実体を探します。見つかりました、それではこの関数をエディタで開いてみます。

行番号をクリックするとその場所を示すパスが表示されるのでコピーしておきます。
●行番号をクリック、テキストファイルに貼付け

このパスをgmilkというコマンドツールに渡すとファイルの実体を見つけることが出来ます。
●gmilk eeeee、エディタでファイルにジャンプ

●エディタとブラウザを左右に並べて開く
同じ箇所をブラウザとエディタの両方で開くことが出来ました。

Milkodeを使うとこのように快適にコードリーディングを進めることが出来ます。今日ご紹介したデモ環境は私のノートパソコン上で動かしています。TokyuRuby会議中は触れるようにしておきますので、良かったら感触を確かめに遊びに来て下さい。

!! ページ4: インストール
インストールは gem install milkode で簡単に出来ます。

!! ページ5: ありがとうございました
Milkodeはまだまだ発展途中のソフトウェアのため、皆さんに使って頂きフィードバックがもらえればと思っています。
何か気になることがありましたらTwitterやメール等で教えて頂ければ幸いです。

どうもありがとうございました。
