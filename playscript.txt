! TokyuRuby会議05 LT 原稿

!! 準備
○エディタを起動
○ブラウザ 6 エディタ 5
○$ cd milkode_tokyu05 && milk web
○$ milk setdb milkode_tokyu05
○スライド開く、フルスクリーンモード
○デモがもたつくのでテキパキ行うよう努める

!! ページ1: Rubyで作ったソースコード検索エンジンMilkode
●スライドをフルスクリーン、文字サイズを調整する

こんにちはongaeshiと申します。今日は私が開発しているソースコード検索エンジンのMilkodeをご紹介させて頂きたいと思います。

!! ページ2: コードを読むことの重要性は年々向上・・
コードを読むことの重要性は年々向上しています。

!! ページ2: しかし、支援するためのツールは変わっていない・・
しかし、そのためのツールは昔から余り変わっていません。

grepは検索に時間がかかりますし、Koders.com等のソースコード検索エンジンはAND検索が出来なかったり非公開のソースコードを検索することが出来ません。

● [ENTER] もっとコードリーディングを簡単にしたい

これらの不満点を解消し、もっとコードリーディングを簡単に行えるようにするためにMilkodeの開発を始めました。

!! ページ3: Milkodeの特徴
Milkodeの特徴です。

● [ENTER] 高速
まずはその高速性です。 20000ファイル位であれば1秒以内に検索することが出来ます。

● [ENTER] 行指向
Milkodeは行指向の検索エンジンです。一般的に検索エンジンは「特定の単語を含むファイル」を見つけますが、Milkodeは「特定の単語を含む行」を見つけます。 

● [ENTER] エディタでもブラウザでも
webアプリとコマンドラインツールを状況に応じて使い分けることが出来ます。

!! ページ4: デモ
それでは実際に動いている所をご紹介したいと思います。

● フルスクリーン解除(Cmd+Shift+F) -> milk web画面を開く -> 再度フルスクリーン
milk web コマンドでアプリを起動するとこのような画面が表示されます。

現在はruby, mruby, node.js, rails 等のソースコードが登録されており、全部で13207ファイルあります。
では試しに mrubyの String#split の実装を検索してみましょう。
まずはAND検索を使ってエントリポイントを探します、 rb_deine_method split .. はい出て来ました。10000程度のファイルであればこれ位のスピード感で検索することが出来ます。
● [ENTER] rb_define_method split

試しにrubyで同じキーワードで検索すると..、String以外にPathnameやBigdecimalにもsplitメソッドがあることが分かります。
● パッケージrubyに切り替え

mruby に戻りましょう。
● パッケージmrubyに切り替え

mrb_str_split_m 関数の実体を探します。見つかりました。このように使い慣れたブラウザを使って目的の関数を簡単に見つけることが出来ました。
● [ENTER] mrb_str_split_m

さらにgmilkというコマンドラインツールを使うとブラウザで開いている箇所を使い慣れたエディタで開くことも可能です。
●行番号をクリック、テキストファイルに貼付け
●gmilk eeeee、エディタでファイルにジャンプ

Milkodeを使うとこのように快適にコードリーディングを進めることが出来ます。今日ご紹介したデモ環境は私のノートパソコン上で動かしています。TokyuRuby会議中は触れるようにしておきますので良かったら感触を確かめに遊びに来て下さい。

!! ページ4: インストール
インストールは gem install milkode で簡単に出来ます。

!! ページ5: ありがとうございました
Milkodeはまだまだ発展途中のソフトウェアのため、皆さんに使って頂きフィードバックがもらえればと思っています。
何か気になることがありましたらTwitterやメール等で教えて頂ければ幸いです。

どうもありがとうございました。
